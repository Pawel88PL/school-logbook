2025-05-01 09:49:02.708 +02:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5234/api/auth/login - null null
2025-05-01 09:49:02.753 +02:00 [INF] CORS policy execution successful.
2025-05-01 09:49:02.754 +02:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5234/api/auth/login - 204 null null 47.3075ms
2025-05-01 09:49:02.755 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5234/api/auth/login - application/json 55
2025-05-01 09:49:02.756 +02:00 [INF] CORS policy execution successful.
2025-05-01 09:49:02.761 +02:00 [INF] Executing endpoint 'backend.Controllers.AuthController.Login (backend)'
2025-05-01 09:49:02.766 +02:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(backend.DTOs.Login) on controller backend.Controllers.AuthController (backend).
2025-05-01 09:49:02.991 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[AdminId], [a].[ConcurrencyStamp], [a].[DateAdded], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastSuccessfulLogin], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[StudentId], [a].[TeacherId], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-05-01 09:49:03.070 +02:00 [INF] Executed DbCommand (27ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-05-01 09:49:03.096 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-05-01 09:49:03.122 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-05-01 09:49:03.146 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2025-05-01 09:49:03.168 +02:00 [INF] AuthenticationScheme: Identity.Application signed in.
2025-05-01 09:49:03.192 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[AdminId], [a].[ConcurrencyStamp], [a].[DateAdded], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastSuccessfulLogin], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[StudentId], [a].[TeacherId], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-05-01 09:49:03.194 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.Threading.Tasks.Task`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-01 09:49:03.220 +02:00 [INF] Executed DbCommand (27ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-05-01 09:49:03.248 +02:00 [INF] Executed DbCommand (27ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[AdminId], [a].[ConcurrencyStamp], [a].[DateAdded], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastSuccessfulLogin], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[StudentId], [a].[TeacherId], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-05-01 09:49:03.276 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[@p20='?' (Size = 450), @p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p21='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTimeOffset), @p10='?' (Size = 256), @p11='?' (Size = 256), @p12='?' (Size = 4000), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (Size = 4000), @p16='?' (DbType = Int32), @p17='?' (DbType = Int32), @p18='?' (DbType = Boolean), @p19='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p0, [AdminId] = @p1, [ConcurrencyStamp] = @p2, [DateAdded] = @p3, [Email] = @p4, [EmailConfirmed] = @p5, [IsActive] = @p6, [LastSuccessfulLogin] = @p7, [LockoutEnabled] = @p8, [LockoutEnd] = @p9, [NormalizedEmail] = @p10, [NormalizedUserName] = @p11, [PasswordHash] = @p12, [PhoneNumber] = @p13, [PhoneNumberConfirmed] = @p14, [SecurityStamp] = @p15, [StudentId] = @p16, [TeacherId] = @p17, [TwoFactorEnabled] = @p18, [UserName] = @p19
OUTPUT 1
WHERE [Id] = @p20 AND [ConcurrencyStamp] = @p21;
2025-05-01 09:49:03.279 +02:00 [INF] Executed action backend.Controllers.AuthController.Login (backend) in 513.0189ms
2025-05-01 09:49:03.279 +02:00 [INF] Executed endpoint 'backend.Controllers.AuthController.Login (backend)'
2025-05-01 09:49:03.280 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5234/api/auth/login - 200 null application/json; charset=utf-8 524.4755ms
2025-05-01 09:49:03.283 +02:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5234/api/user/logged-user - null null
2025-05-01 09:49:03.284 +02:00 [INF] CORS policy execution successful.
2025-05-01 09:49:03.284 +02:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5234/api/user/logged-user - 204 null null 0.6484ms
2025-05-01 09:49:03.285 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5234/api/user/logged-user - null null
2025-05-01 09:49:03.286 +02:00 [INF] CORS policy execution successful.
2025-05-01 09:49:03.287 +02:00 [INF] Executing endpoint 'backend.Controllers.UserController.GetLoggedUser (backend)'
2025-05-01 09:49:03.287 +02:00 [INF] Route matched with {action = "GetLoggedUser", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLoggedUser() on controller backend.Controllers.UserController (backend).
2025-05-01 09:49:03.316 +02:00 [INF] Executed DbCommand (27ms) [Parameters=[@__id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[AdminId], [a].[ConcurrencyStamp], [a].[DateAdded], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastSuccessfulLogin], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[StudentId], [a].[TeacherId], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__id_0
2025-05-01 09:49:03.320 +02:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - null null
2025-05-01 09:49:03.320 +02:00 [INF] CORS policy execution successful.
2025-05-01 09:49:03.320 +02:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - 204 null null 0.3924ms
2025-05-01 09:49:03.325 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - null null
2025-05-01 09:49:03.326 +02:00 [INF] CORS policy execution successful.
2025-05-01 09:49:03.327 +02:00 [INF] Executing endpoint 'backend.Controllers.UserController.GetUsersPaged (backend)'
2025-05-01 09:49:03.327 +02:00 [INF] Route matched with {action = "GetUsersPaged", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersPaged(backend.Models.PagedRequest) on controller backend.Controllers.UserController (backend).
2025-05-01 09:49:03.344 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-05-01 09:49:03.372 +02:00 [INF] Executed DbCommand (27ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[FirstName], [a].[LastName], [a].[UserId]
FROM [Admins] AS [a]
WHERE [a].[UserId] = @__userId_0
2025-05-01 09:49:03.373 +02:00 [INF] Executing OkObjectResult, writing value of type 'backend.DTOs.SimpleUserDto'.
2025-05-01 09:49:03.373 +02:00 [INF] Executed action backend.Controllers.UserController.GetLoggedUser (backend) in 86.1404ms
2025-05-01 09:49:03.373 +02:00 [INF] Executed endpoint 'backend.Controllers.UserController.GetLoggedUser (backend)'
2025-05-01 09:49:03.374 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5234/api/user/logged-user - 200 null application/json; charset=utf-8 88.185ms
2025-05-01 09:49:03.510 +02:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
INNER JOIN [AspNetUserRoles] AS [a0] ON [a].[Id] = [a0].[UserId]
INNER JOIN [AspNetRoles] AS [a1] ON [a0].[RoleId] = [a1].[Id]
LEFT JOIN [Admins] AS [a2] ON [a].[Id] = [a2].[UserId]
LEFT JOIN [Teachers] AS [t] ON [a].[Id] = [t].[UserId]
LEFT JOIN [Students] AS [s] ON [a].[Id] = [s].[UserId]
2025-05-01 09:49:03.536 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AccessFailedCount], [a].[AdminId], [a].[ConcurrencyStamp], [a].[DateAdded], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastSuccessfulLogin], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[StudentId], [a].[TeacherId], [a].[TwoFactorEnabled], [a].[UserName], [a1].[Name] AS [RoleName], [a2].[Id], [a2].[FirstName], [a2].[LastName], [a2].[UserId], [t].[Id], [t].[FirstName], [t].[LastName], [t].[UserId], [s].[Id], [s].[ClassId], [s].[FirstName], [s].[LastName], [s].[UserId]
FROM [AspNetUsers] AS [a]
INNER JOIN [AspNetUserRoles] AS [a0] ON [a].[Id] = [a0].[UserId]
INNER JOIN [AspNetRoles] AS [a1] ON [a0].[RoleId] = [a1].[Id]
LEFT JOIN [Admins] AS [a2] ON [a].[Id] = [a2].[UserId]
LEFT JOIN [Teachers] AS [t] ON [a].[Id] = [t].[UserId]
LEFT JOIN [Students] AS [s] ON [a].[Id] = [s].[UserId]
ORDER BY [a1].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-05-01 09:49:03.538 +02:00 [INF] Executing OkObjectResult, writing value of type 'backend.DTOs.PagedUsers'.
2025-05-01 09:49:03.538 +02:00 [INF] Executed action backend.Controllers.UserController.GetUsersPaged (backend) in 210.8085ms
2025-05-01 09:49:03.539 +02:00 [INF] Executed endpoint 'backend.Controllers.UserController.GetUsersPaged (backend)'
2025-05-01 09:49:03.539 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - 200 null application/json; charset=utf-8 214.484ms
2025-05-01 09:49:14.748 +02:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5234/api/user/delete/588b0138-6c6f-41f6-a0c3-68b2246f7701 - null null
2025-05-01 09:49:14.751 +02:00 [INF] CORS policy execution successful.
2025-05-01 09:49:14.752 +02:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5234/api/user/delete/588b0138-6c6f-41f6-a0c3-68b2246f7701 - 204 null null 3.9624ms
2025-05-01 09:49:14.753 +02:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5234/api/user/delete/588b0138-6c6f-41f6-a0c3-68b2246f7701 - null null
2025-05-01 09:49:14.756 +02:00 [INF] CORS policy execution successful.
2025-05-01 09:49:14.759 +02:00 [INF] Executing endpoint 'backend.Controllers.UserController.DeleteUser (backend)'
2025-05-01 09:49:14.772 +02:00 [INF] Route matched with {action = "DeleteUser", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] DeleteUser(System.String) on controller backend.Controllers.UserController (backend).
2025-05-01 09:49:14.828 +02:00 [INF] Executed DbCommand (28ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[AdminId], [a].[ConcurrencyStamp], [a].[DateAdded], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastSuccessfulLogin], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[StudentId], [a].[TeacherId], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-05-01 09:49:14.873 +02:00 [INF] Executed DbCommand (31ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [AspNetUsers]
OUTPUT 1
WHERE [Id] = @p0 AND [ConcurrencyStamp] = @p1;
2025-05-01 09:49:14.903 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'backend.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Admins_AspNetUsers_UserId". The conflict occurred in database "school-logbook", table "dbo.Admins", column 'UserId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:629e77e0-d5d8-4a3a-9185-ae87641bd8f3
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Admins_AspNetUsers_UserId". The conflict occurred in database "school-logbook", table "dbo.Admins", column 'UserId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:629e77e0-d5d8-4a3a-9185-ae87641bd8f3
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-01 09:49:14.906 +02:00 [ERR] Wystąpił błąd podczas usuwania użytkownika.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The DELETE statement conflicted with the REFERENCE constraint "FK_Admins_AspNetUsers_UserId". The conflict occurred in database "school-logbook", table "dbo.Admins", column 'UserId'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:629e77e0-d5d8-4a3a-9185-ae87641bd8f3
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore`9.DeleteAsync(TUser user, CancellationToken cancellationToken)
   at backend.Services.UserService.DeleteUserAsync(String userId) in /Users/pawelstaniul/Desktop/Programy/school-logbook/backend/Services/UserService.cs:line 91
   at backend.Controllers.UserController.DeleteUser(String id) in /Users/pawelstaniul/Desktop/Programy/school-logbook/backend/Controllers/UserController.cs:line 57
2025-05-01 09:49:14.912 +02:00 [INF] Executing ObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-01 09:49:14.915 +02:00 [INF] Executed action backend.Controllers.UserController.DeleteUser (backend) in 142.964ms
2025-05-01 09:49:14.915 +02:00 [INF] Executed endpoint 'backend.Controllers.UserController.DeleteUser (backend)'
2025-05-01 09:49:14.915 +02:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5234/api/user/delete/588b0138-6c6f-41f6-a0c3-68b2246f7701 - 500 null application/json; charset=utf-8 161.8553ms
2025-05-01 09:51:09.318 +02:00 [INF] Application is shutting down...
2025-05-01 09:53:23.395 +02:00 [INF] Application is starting
2025-05-01 09:53:23.426 +02:00 [INF] User profile is available. Using '/Users/pawelstaniul/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
2025-05-01 09:53:23.454 +02:00 [WRN] The WebRootPath was not found: /Users/pawelstaniul/Desktop/Programy/school-logbook/backend/wwwroot. Static files may be unavailable.
2025-05-01 09:53:23.460 +02:00 [INF] Now listening on: http://localhost:5234
2025-05-01 09:53:23.462 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-01 09:53:23.462 +02:00 [INF] Hosting environment: Development
2025-05-01 09:53:23.462 +02:00 [INF] Content root path: /Users/pawelstaniul/Desktop/Programy/school-logbook/backend
2025-05-01 09:53:23.812 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5234/swagger/index.html - null null
2025-05-01 09:53:23.862 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5234/swagger/index.html - 200 null text/html;charset=utf-8 50.4661ms
2025-05-01 09:53:23.874 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5234/_framework/aspnetcore-browser-refresh.js - null null
2025-05-01 09:53:23.874 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5234/swagger/swagger-ui-bundle.js - null null
2025-05-01 09:53:23.874 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5234/swagger/swagger-ui-standalone-preset.js - null null
2025-05-01 09:53:23.877 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5234/_framework/aspnetcore-browser-refresh.js - 200 13732 application/javascript; charset=utf-8 2.6265ms
2025-05-01 09:53:23.892 +02:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-05-01 09:53:23.894 +02:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-05-01 09:53:23.894 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5234/swagger/swagger-ui-standalone-preset.js - 200 339486 text/javascript 19.8919ms
2025-05-01 09:53:23.894 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5234/swagger/swagger-ui-bundle.js - 200 1096145 text/javascript 20.1946ms
2025-05-01 09:53:23.985 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5234/swagger/v1/swagger.json - null null
2025-05-01 09:53:24.027 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5234/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 42.3996ms
2025-05-01 10:00:24.518 +02:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5234/api/user/logged-user - null null
2025-05-01 10:00:24.527 +02:00 [WRN] Failed to determine the https port for redirect.
2025-05-01 10:00:24.571 +02:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - null null
2025-05-01 10:00:24.587 +02:00 [INF] CORS policy execution successful.
2025-05-01 10:00:24.587 +02:00 [INF] CORS policy execution successful.
2025-05-01 10:00:24.588 +02:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5234/api/user/logged-user - 204 null null 70.6066ms
2025-05-01 10:00:24.588 +02:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - 204 null null 17.0287ms
2025-05-01 10:00:24.590 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - null null
2025-05-01 10:00:24.590 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5234/api/user/logged-user - null null
2025-05-01 10:00:24.592 +02:00 [INF] CORS policy execution successful.
2025-05-01 10:00:24.592 +02:00 [INF] CORS policy execution successful.
2025-05-01 10:00:24.710 +02:00 [INF] Executing endpoint 'backend.Controllers.UserController.GetLoggedUser (backend)'
2025-05-01 10:00:24.711 +02:00 [INF] Executing endpoint 'backend.Controllers.UserController.GetUsersPaged (backend)'
2025-05-01 10:00:24.753 +02:00 [INF] Route matched with {action = "GetLoggedUser", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLoggedUser() on controller backend.Controllers.UserController (backend).
2025-05-01 10:00:24.760 +02:00 [INF] Route matched with {action = "GetUsersPaged", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersPaged(backend.Models.PagedRequest) on controller backend.Controllers.UserController (backend).
2025-05-01 10:00:25.693 +02:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
INNER JOIN [AspNetUserRoles] AS [a0] ON [a].[Id] = [a0].[UserId]
INNER JOIN [AspNetRoles] AS [a1] ON [a0].[RoleId] = [a1].[Id]
LEFT JOIN [Admins] AS [a2] ON [a].[Id] = [a2].[UserId]
LEFT JOIN [Teachers] AS [t] ON [a].[Id] = [t].[UserId]
LEFT JOIN [Students] AS [s] ON [a].[Id] = [s].[UserId]
2025-05-01 10:00:25.760 +02:00 [INF] Executed DbCommand (43ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AccessFailedCount], [a].[AdminId], [a].[ConcurrencyStamp], [a].[DateAdded], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastSuccessfulLogin], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[StudentId], [a].[TeacherId], [a].[TwoFactorEnabled], [a].[UserName], [a1].[Name] AS [RoleName], [a2].[Id], [a2].[FirstName], [a2].[LastName], [a2].[UserId], [t].[Id], [t].[FirstName], [t].[LastName], [t].[UserId], [s].[Id], [s].[ClassId], [s].[FirstName], [s].[LastName], [s].[UserId]
FROM [AspNetUsers] AS [a]
INNER JOIN [AspNetUserRoles] AS [a0] ON [a].[Id] = [a0].[UserId]
INNER JOIN [AspNetRoles] AS [a1] ON [a0].[RoleId] = [a1].[Id]
LEFT JOIN [Admins] AS [a2] ON [a].[Id] = [a2].[UserId]
LEFT JOIN [Teachers] AS [t] ON [a].[Id] = [t].[UserId]
LEFT JOIN [Students] AS [s] ON [a].[Id] = [s].[UserId]
ORDER BY [a1].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-05-01 10:00:25.766 +02:00 [INF] Executing OkObjectResult, writing value of type 'backend.DTOs.PagedUsers'.
2025-05-01 10:00:25.774 +02:00 [INF] Executed action backend.Controllers.UserController.GetUsersPaged (backend) in 1012.8869ms
2025-05-01 10:00:25.774 +02:00 [INF] Executed endpoint 'backend.Controllers.UserController.GetUsersPaged (backend)'
2025-05-01 10:00:25.777 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - 200 null application/json; charset=utf-8 1186.7954ms
2025-05-01 10:00:25.794 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[@__id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[AdminId], [a].[ConcurrencyStamp], [a].[DateAdded], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastSuccessfulLogin], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[StudentId], [a].[TeacherId], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__id_0
2025-05-01 10:00:25.838 +02:00 [INF] Executed DbCommand (34ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-05-01 10:00:25.888 +02:00 [INF] Executed DbCommand (45ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[FirstName], [a].[LastName], [a].[UserId]
FROM [Admins] AS [a]
WHERE [a].[UserId] = @__userId_0
2025-05-01 10:00:25.889 +02:00 [INF] Executing OkObjectResult, writing value of type 'backend.DTOs.SimpleUserDto'.
2025-05-01 10:00:25.890 +02:00 [INF] Executed action backend.Controllers.UserController.GetLoggedUser (backend) in 1136.2906ms
2025-05-01 10:00:25.890 +02:00 [INF] Executed endpoint 'backend.Controllers.UserController.GetLoggedUser (backend)'
2025-05-01 10:00:25.890 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5234/api/user/logged-user - 200 null application/json; charset=utf-8 1300.1084ms
2025-05-01 10:00:36.392 +02:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5234/api/user/delete/588b0138-6c6f-41f6-a0c3-68b2246f7701 - null null
2025-05-01 10:00:36.398 +02:00 [INF] CORS policy execution successful.
2025-05-01 10:00:36.400 +02:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5234/api/user/delete/588b0138-6c6f-41f6-a0c3-68b2246f7701 - 204 null null 7.9025ms
2025-05-01 10:00:36.402 +02:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5234/api/user/delete/588b0138-6c6f-41f6-a0c3-68b2246f7701 - null null
2025-05-01 10:00:36.404 +02:00 [INF] CORS policy execution successful.
2025-05-01 10:00:36.410 +02:00 [INF] Executing endpoint 'backend.Controllers.UserController.DeleteUser (backend)'
2025-05-01 10:00:36.415 +02:00 [INF] Route matched with {action = "DeleteUser", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] DeleteUser(System.String) on controller backend.Controllers.UserController (backend).
2025-05-01 10:00:36.540 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[AdminId], [a].[ConcurrencyStamp], [a].[DateAdded], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastSuccessfulLogin], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[StudentId], [a].[TeacherId], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-05-01 10:00:36.606 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-05-01 10:00:36.632 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[FirstName], [a].[LastName], [a].[UserId]
FROM [Admins] AS [a]
WHERE [a].[UserId] = @__userId_0
2025-05-01 10:00:36.744 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Admins]
OUTPUT 1
WHERE [Id] = @p0;
2025-05-01 10:00:36.806 +02:00 [INF] Executed DbCommand (27ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [AspNetUsers]
OUTPUT 1
WHERE [Id] = @p0 AND [ConcurrencyStamp] = @p1;
2025-05-01 10:00:36.840 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-05-01 10:00:36.840 +02:00 [INF] Executed action backend.Controllers.UserController.DeleteUser (backend) in 424.863ms
2025-05-01 10:00:36.840 +02:00 [INF] Executed endpoint 'backend.Controllers.UserController.DeleteUser (backend)'
2025-05-01 10:00:36.840 +02:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5234/api/user/delete/588b0138-6c6f-41f6-a0c3-68b2246f7701 - 200 0 null 438.0941ms
2025-05-01 10:00:36.851 +02:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - null null
2025-05-01 10:00:36.852 +02:00 [INF] CORS policy execution successful.
2025-05-01 10:00:36.852 +02:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - 204 null null 0.886ms
2025-05-01 10:00:36.853 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - null null
2025-05-01 10:00:36.854 +02:00 [INF] CORS policy execution successful.
2025-05-01 10:00:36.857 +02:00 [INF] Executing endpoint 'backend.Controllers.UserController.GetUsersPaged (backend)'
2025-05-01 10:00:36.858 +02:00 [INF] Route matched with {action = "GetUsersPaged", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersPaged(backend.Models.PagedRequest) on controller backend.Controllers.UserController (backend).
2025-05-01 10:00:36.888 +02:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
INNER JOIN [AspNetUserRoles] AS [a0] ON [a].[Id] = [a0].[UserId]
INNER JOIN [AspNetRoles] AS [a1] ON [a0].[RoleId] = [a1].[Id]
LEFT JOIN [Admins] AS [a2] ON [a].[Id] = [a2].[UserId]
LEFT JOIN [Teachers] AS [t] ON [a].[Id] = [t].[UserId]
LEFT JOIN [Students] AS [s] ON [a].[Id] = [s].[UserId]
2025-05-01 10:00:36.916 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AccessFailedCount], [a].[AdminId], [a].[ConcurrencyStamp], [a].[DateAdded], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastSuccessfulLogin], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[StudentId], [a].[TeacherId], [a].[TwoFactorEnabled], [a].[UserName], [a1].[Name] AS [RoleName], [a2].[Id], [a2].[FirstName], [a2].[LastName], [a2].[UserId], [t].[Id], [t].[FirstName], [t].[LastName], [t].[UserId], [s].[Id], [s].[ClassId], [s].[FirstName], [s].[LastName], [s].[UserId]
FROM [AspNetUsers] AS [a]
INNER JOIN [AspNetUserRoles] AS [a0] ON [a].[Id] = [a0].[UserId]
INNER JOIN [AspNetRoles] AS [a1] ON [a0].[RoleId] = [a1].[Id]
LEFT JOIN [Admins] AS [a2] ON [a].[Id] = [a2].[UserId]
LEFT JOIN [Teachers] AS [t] ON [a].[Id] = [t].[UserId]
LEFT JOIN [Students] AS [s] ON [a].[Id] = [s].[UserId]
ORDER BY [a1].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-05-01 10:00:36.920 +02:00 [INF] Executing OkObjectResult, writing value of type 'backend.DTOs.PagedUsers'.
2025-05-01 10:00:36.920 +02:00 [INF] Executed action backend.Controllers.UserController.GetUsersPaged (backend) in 62.178ms
2025-05-01 10:00:36.920 +02:00 [INF] Executed endpoint 'backend.Controllers.UserController.GetUsersPaged (backend)'
2025-05-01 10:00:36.920 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - 200 null application/json; charset=utf-8 67.0318ms
2025-05-01 10:00:44.180 +02:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5234/api/user/delete/ac377a85-ecb3-4c29-a683-822a55319f56 - null null
2025-05-01 10:00:44.181 +02:00 [INF] CORS policy execution successful.
2025-05-01 10:00:44.181 +02:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5234/api/user/delete/ac377a85-ecb3-4c29-a683-822a55319f56 - 204 null null 1.1542ms
2025-05-01 10:00:44.185 +02:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5234/api/user/delete/ac377a85-ecb3-4c29-a683-822a55319f56 - null null
2025-05-01 10:00:44.186 +02:00 [INF] CORS policy execution successful.
2025-05-01 10:00:44.187 +02:00 [INF] Executing endpoint 'backend.Controllers.UserController.DeleteUser (backend)'
2025-05-01 10:00:44.187 +02:00 [INF] Route matched with {action = "DeleteUser", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] DeleteUser(System.String) on controller backend.Controllers.UserController (backend).
2025-05-01 10:00:44.316 +02:00 [INF] Executed DbCommand (48ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[AdminId], [a].[ConcurrencyStamp], [a].[DateAdded], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastSuccessfulLogin], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[StudentId], [a].[TeacherId], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-05-01 10:00:44.351 +02:00 [INF] Executed DbCommand (32ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-05-01 10:00:44.394 +02:00 [INF] Executed DbCommand (42ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[FirstName], [a].[LastName], [a].[UserId]
FROM [Admins] AS [a]
WHERE [a].[UserId] = @__userId_0
2025-05-01 10:00:44.450 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Admins]
OUTPUT 1
WHERE [Id] = @p0;
2025-05-01 10:00:44.509 +02:00 [INF] Executed DbCommand (32ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [AspNetUsers]
OUTPUT 1
WHERE [Id] = @p0 AND [ConcurrencyStamp] = @p1;
2025-05-01 10:00:44.548 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-05-01 10:00:44.548 +02:00 [INF] Executed action backend.Controllers.UserController.DeleteUser (backend) in 360.7457ms
2025-05-01 10:00:44.548 +02:00 [INF] Executed endpoint 'backend.Controllers.UserController.DeleteUser (backend)'
2025-05-01 10:00:44.548 +02:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5234/api/user/delete/ac377a85-ecb3-4c29-a683-822a55319f56 - 200 0 null 363.044ms
2025-05-01 10:00:44.558 +02:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - null null
2025-05-01 10:00:44.558 +02:00 [INF] CORS policy execution successful.
2025-05-01 10:00:44.558 +02:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - 204 null null 0.4337ms
2025-05-01 10:00:44.559 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - null null
2025-05-01 10:00:44.560 +02:00 [INF] CORS policy execution successful.
2025-05-01 10:00:44.560 +02:00 [INF] Executing endpoint 'backend.Controllers.UserController.GetUsersPaged (backend)'
2025-05-01 10:00:44.560 +02:00 [INF] Route matched with {action = "GetUsersPaged", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetUsersPaged(backend.Models.PagedRequest) on controller backend.Controllers.UserController (backend).
2025-05-01 10:00:44.590 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
INNER JOIN [AspNetUserRoles] AS [a0] ON [a].[Id] = [a0].[UserId]
INNER JOIN [AspNetRoles] AS [a1] ON [a0].[RoleId] = [a1].[Id]
LEFT JOIN [Admins] AS [a2] ON [a].[Id] = [a2].[UserId]
LEFT JOIN [Teachers] AS [t] ON [a].[Id] = [t].[UserId]
LEFT JOIN [Students] AS [s] ON [a].[Id] = [s].[UserId]
2025-05-01 10:00:44.640 +02:00 [INF] Executed DbCommand (48ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AccessFailedCount], [a].[AdminId], [a].[ConcurrencyStamp], [a].[DateAdded], [a].[Email], [a].[EmailConfirmed], [a].[IsActive], [a].[LastSuccessfulLogin], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[StudentId], [a].[TeacherId], [a].[TwoFactorEnabled], [a].[UserName], [a1].[Name] AS [RoleName], [a2].[Id], [a2].[FirstName], [a2].[LastName], [a2].[UserId], [t].[Id], [t].[FirstName], [t].[LastName], [t].[UserId], [s].[Id], [s].[ClassId], [s].[FirstName], [s].[LastName], [s].[UserId]
FROM [AspNetUsers] AS [a]
INNER JOIN [AspNetUserRoles] AS [a0] ON [a].[Id] = [a0].[UserId]
INNER JOIN [AspNetRoles] AS [a1] ON [a0].[RoleId] = [a1].[Id]
LEFT JOIN [Admins] AS [a2] ON [a].[Id] = [a2].[UserId]
LEFT JOIN [Teachers] AS [t] ON [a].[Id] = [t].[UserId]
LEFT JOIN [Students] AS [s] ON [a].[Id] = [s].[UserId]
ORDER BY [a1].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-05-01 10:00:44.640 +02:00 [INF] Executing OkObjectResult, writing value of type 'backend.DTOs.PagedUsers'.
2025-05-01 10:00:44.641 +02:00 [INF] Executed action backend.Controllers.UserController.GetUsersPaged (backend) in 80.2503ms
2025-05-01 10:00:44.641 +02:00 [INF] Executed endpoint 'backend.Controllers.UserController.GetUsersPaged (backend)'
2025-05-01 10:00:44.641 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5234/api/user/paged?pageNumber=1&pageSize=10&sortColumn=role&sortDirection=asc&searchQuery= - 200 null application/json; charset=utf-8 81.3488ms
